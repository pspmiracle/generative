{"version":3,"sources":["sketches/016_bloody_canvas_game/Bullet.js","sketches/016_bloody_canvas_game/Enemy.js","sketches/016_bloody_canvas_game/Ship.js","utils/sound.js","utils/collection.js","sketches/016_bloody_canvas_game/index.js"],"names":["Bullet","options","Object","entries","key","option","this","color","random","pick","size","baseOptions","fieldSize","speed","initSpeedFactor","moveAngle","enemies","game","bX","x","bY","y","draw","destroy","Math","cos","sin","width","height","items","forEach","enemy","live","sqrt","explode","ctx","onBackground","context","backgroundContext","lineWidth","tailLength","min","max","beginPath","moveTo","lineTo","PI","stroke","fillStyle","arc","fill","bullets","remove","Enemy","sizeFactor","range","particleSize","ship","atan2","maxSpeed","particles","p","a","c","playSound","i","particle","push","Ship","deadTime","document","addEventListener","handleKeyPress","bind","handleKeyUp","canvas","handleMouseMove","handleMouseDown","cursorX","cursorY","moveDirection","up","right","down","left","gunAngle","running","time","dead","bullet","gunTipCoord","add","e","fire","movementX","movementY","code","moveDiff","fromX","fromY","toX","toY","audioCtx","window","AudioContext","webkitAudioContext","frequency","type","volume","o","createOscillator","g","createGain","connect","destination","value","start","gain","exponentialRampToValueAtTime","currentTime","setTimeout","stop","disconnect","Collection","item","filter","Symbol","iterator","values","length","browserSetup","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","sketch","backGroundCanvas","createElement","getContext","fillRect","gridCanvas","gridContext","strokeStyle","createEnemy","drawImage","floor","update","save","translate","rotate","font","textAlign","fillText","restore","settings","dimensions","animate"],"mappings":"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","file":"static/js/27.c0f68fa2.chunk.js","sourcesContent":["import random from 'canvas-sketch-util/random';\n\nexport default class Bullet {\n  constructor(options) {\n    for (const [key, option] of Object.entries(options)) {\n      this[key] = option;\n    }\n\n    this.color = random.pick(['#4b86b4', '#adcbe3', '#63ace5']);\n    this.size = this.baseOptions.fieldSize / 100;\n    this.speed = (this.baseOptions.fieldSize / 100) * this.initSpeedFactor;\n  }\n\n  update() {\n    const {\n      moveAngle,\n      game: { enemies },\n    } = this;\n\n    this.bX = this.x;\n    this.bY = this.y;\n\n    this.speed += -0.1;\n\n    if (this.speed <= 0) {\n      this.draw(true);\n      this.destroy();\n    } else {\n      this.x += Math.cos(moveAngle) * this.speed;\n      this.y += Math.sin(moveAngle) * this.speed;\n    }\n\n    if (\n      this.x < -100 ||\n      this.x > this.baseOptions.width + 100 ||\n      this.y < -100 ||\n      this.y > this.baseOptions.height + 100\n    ) {\n      this.destroy();\n    }\n\n    enemies.items.forEach(enemy => {\n      if (enemy.live) {\n        const distance = Math.sqrt((this.x - enemy.x) ** 2 + (this.y - enemy.y) ** 2);\n        if (distance < enemy.size) {\n          enemy.explode();\n          this.destroy();\n        }\n      }\n    });\n  }\n\n  draw(onBackground = false) {\n    const {\n      baseOptions: { context, backgroundContext },\n      x,\n      y,\n    } = this;\n\n    let ctx;\n    if (onBackground) {\n      ctx = backgroundContext;\n    } else {\n      ctx = context;\n    }\n\n    ctx.lineWidth = this.size / 10;\n\n    // Tail\n    const tailLength = Math.min(this.size * Math.max(this.speed, 1), this.size * 5);\n    ctx.beginPath();\n    ctx.moveTo(this.x, this.y);\n    ctx.lineTo(\n      this.x + Math.cos(this.moveAngle - Math.PI) * tailLength,\n      this.y + Math.sin(this.moveAngle - Math.PI) * tailLength,\n    );\n    ctx.stroke();\n\n    // Body\n    ctx.fillStyle = this.color;\n    ctx.beginPath();\n    ctx.arc(x, y, this.size / 2, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.stroke();\n  }\n\n  destroy() {\n    this.game.bullets.remove(this);\n  }\n}\n","import random from 'canvas-sketch-util/random';\nimport { playSound } from '@/utils/sound';\n\nexport default class Enemy {\n  constructor(options) {\n    for (const [key, option] of Object.entries(options)) {\n      this[key] = option;\n    }\n\n    this.live = true;\n    this.sizeFactor = random.range(20, 30);\n    this.size = this.baseOptions.fieldSize * (1 / this.sizeFactor);\n    this.particleSize = this.baseOptions.fieldSize / 100;\n    this.speed = this.baseOptions.fieldSize / (this.sizeFactor * 10);\n\n    this.moveAngle = Math.PI / 2;\n  }\n\n  update() {\n    const {\n      game: { ship },\n    } = this;\n\n    if (this.live) {\n      this.moveAngle = Math.atan2(ship.y - this.y, ship.x - this.x);\n\n      this.x += Math.cos(this.moveAngle) * this.speed;\n      this.y += Math.sin(this.moveAngle) * this.speed;\n\n      const distanceToShip = Math.sqrt((this.x - ship.x) ** 2 + (this.y - ship.y) ** 2);\n      if (distanceToShip < this.size / 2 + ship.size / 2) {\n        ship.explode();\n        this.destroy();\n      }\n    } else {\n      let maxSpeed = 0;\n      this.particles.forEach(p => {\n        p.x += Math.cos(p.a) * p.speed;\n        p.y += Math.sin(p.a) * p.speed;\n        p.speed = Math.max(p.speed - (1 - 1 / p.speed), 1);\n\n        maxSpeed = Math.max(maxSpeed, p.speed);\n\n        return p;\n      });\n      if (maxSpeed <= 1) {\n        this.draw(true);\n        this.destroy();\n      }\n    }\n  }\n\n  draw(onBackground = false) {\n    const {\n      baseOptions: { context, backgroundContext },\n      x,\n      y,\n    } = this;\n\n    let ctx;\n    if (onBackground) {\n      ctx = backgroundContext;\n    } else {\n      ctx = context;\n    }\n\n    if (this.live) {\n      // Body\n      ctx.fillStyle = '#ff6f69';\n      ctx.lineWidth = this.size / 30;\n      ctx.beginPath();\n      ctx.arc(x, y, this.size / 2, 0, Math.PI * 2);\n      ctx.fill();\n      ctx.stroke();\n\n      // Track\n      backgroundContext.fillStyle = 'hsla(0,0%,98%,0.1)';\n      backgroundContext.beginPath();\n      backgroundContext.arc(x, y, this.size / 2, 0, Math.PI * 2);\n      backgroundContext.fill();\n    } else {\n      this.particles.forEach(({ x, y, size, c }) => {\n        ctx.fillStyle = c;\n        ctx.beginPath();\n        ctx.arc(x, y, size / 2, 0, Math.PI * 2);\n        ctx.fill();\n      });\n    }\n  }\n\n  explode() {\n    playSound(random.pick([349.2 + 100, 392.0 + 100, 440.0 + 100]), 'sine', 0.12);\n\n    this.live = false;\n    this.particles = [];\n    for (let i = 0; i < this.sizeFactor * 2; i += 1) {\n      const particle = {\n        x: this.x + random.range(-this.size, this.size),\n        y: this.y + random.range(-this.size, this.size),\n        speed: random.range(5, 10),\n        size: this.particleSize * random.range(0.5, 1.5),\n        c: `hsl(0, 100%,${random.range(40, 60)}%)`,\n      };\n\n      particle.a = Math.atan2(particle.y - this.y, particle.x - this.x);\n\n      this.particles.push(particle);\n    }\n  }\n\n  destroy() {\n    this.game.enemies.remove(this);\n  }\n}\n","import { playSound } from '@/utils/sound';\nimport random from 'canvas-sketch-util/random';\nimport Bullet from './Bullet';\n\nexport default class Ship {\n  constructor(options) {\n    for (const [key, option] of Object.entries(options)) {\n      this[key] = option;\n    }\n\n    this.deadTime = 0;\n\n    this.size = this.baseOptions.fieldSize / 50;\n\n    document.addEventListener('keydown', this.handleKeyPress.bind(this));\n    document.addEventListener('keyup', this.handleKeyUp.bind(this));\n\n    this.baseOptions.canvas.addEventListener('mousemove', this.handleMouseMove.bind(this));\n    this.baseOptions.canvas.addEventListener('mousedown', this.handleMouseDown.bind(this));\n\n    this.cursorX = 0;\n    this.cursorY = 0;\n\n    this.moveDirection = {\n      up: false,\n      right: false,\n      down: false,\n      left: false,\n    };\n    this.gunAngle = Math.PI;\n  }\n\n  fire() {\n    if (!this.game.running) {\n      this.game.ship.deadTime = this.game.time;\n      this.game.running = true;\n      playSound(random.pick([100]), 'sine', 1, 0.5);\n      return;\n    }\n\n    if (this.dead) {\n      return;\n    }\n\n    const { baseOptions, game } = this;\n    // playSound(random.pick([698.5, 784.0, 880.0]), 'sawtooth', 0.08);\n    playSound(random.pick([311.1, 370.0, 415.3]), 'sawtooth', 0.1, 0.5);\n    playSound(random.pick([155.6, 185.0, 207.7]), 'sine', 0.2, 0.5);\n\n    for (let i = 0; i < 8; i += 1) {\n      const bullet = new Bullet({\n        baseOptions,\n        game,\n        x: this.gunTipCoord[0],\n        y: this.gunTipCoord[1],\n        moveAngle: this.gunAngle + random.range(-Math.PI / 32, Math.PI / 32),\n        initSpeedFactor: random.range(0.8, 1.2),\n      });\n      game.bullets.add(bullet);\n    }\n  }\n\n  explode() {\n    playSound(87.31, 'triangle', 0.1);\n\n    const { x, y, baseOptions, game } = this;\n    this.dead = true;\n    this.deadTime = game.time;\n\n    for (let a = -Math.PI; a < Math.PI; a += Math.PI / 50) {\n      const bullet = new Bullet({\n        baseOptions,\n        game,\n        x,\n        y,\n        moveAngle: a,\n        initSpeedFactor: random.range(0.8, 1.2),\n      });\n      game.bullets.add(bullet);\n    }\n  }\n\n  handleMouseDown(e) {\n    this.fire();\n  }\n\n  handleMouseMove(e) {\n    const { movementX, movementY } = e;\n\n    this.cursorX += movementX;\n    this.cursorY += movementY;\n\n    this.gunAngle = Math.atan2(this.cursorY, this.cursorX);\n\n    this.cursorX = 200 * Math.cos(this.gunAngle);\n    this.cursorY = 200 * Math.sin(this.gunAngle);\n  }\n\n  handleKeyPress(e) {\n    switch (e.code) {\n      case 'ArrowUp':\n      case 'KeyW': {\n        this.moveDirection.up = true;\n        break;\n      }\n      case 'ArrowRight':\n      case 'KeyD': {\n        this.moveDirection.right = true;\n        break;\n      }\n      case 'ArrowDown':\n      case 'KeyS': {\n        this.moveDirection.down = true;\n        break;\n      }\n      case 'ArrowLeft':\n      case 'KeyA': {\n        this.moveDirection.left = true;\n        break;\n      }\n      default:\n    }\n  }\n\n  handleKeyUp(e) {\n    switch (e.code) {\n      case 'ArrowUp':\n      case 'KeyW': {\n        this.moveDirection.up = false;\n        break;\n      }\n      case 'ArrowRight':\n      case 'KeyD': {\n        this.moveDirection.right = false;\n        break;\n      }\n      case 'ArrowDown':\n      case 'KeyS': {\n        this.moveDirection.down = false;\n        break;\n      }\n      case 'ArrowLeft':\n      case 'KeyA': {\n        this.moveDirection.left = false;\n        break;\n      }\n      default:\n    }\n  }\n\n  update() {\n    if (this.dead) {\n      if (this.game.time - this.deadTime > 1) {\n        this.dead = false;\n      }\n      return;\n    }\n    const moveDiff = this.baseOptions.fieldSize / 300;\n    if (this.moveDirection.up) {\n      this.y += -moveDiff;\n    }\n    if (this.moveDirection.right) {\n      this.x += moveDiff;\n    }\n    if (this.moveDirection.down) {\n      this.y += moveDiff;\n    }\n    if (this.moveDirection.left) {\n      this.x -= moveDiff;\n    }\n\n    this.x = Math.max(Math.min(this.baseOptions.width, this.x), 0);\n    this.y = Math.max(Math.min(this.baseOptions.height, this.y), 0);\n  }\n\n  draw() {\n    const {\n      baseOptions: { context },\n      x,\n      y,\n      gunAngle,\n    } = this;\n\n    if (this.dead) {\n      return;\n    }\n\n    // Body\n    context.fillStyle = `#96ceb4`;\n    context.lineWidth = this.size / 10;\n    context.beginPath();\n    context.arc(x, y, this.size / 2, 0, Math.PI * 2);\n    context.fill();\n    context.stroke();\n\n    // Gun\n    context.beginPath();\n    const fromX = (Math.cos(gunAngle) * this.size) / 2;\n    const fromY = (Math.sin(gunAngle) * this.size) / 2;\n\n    const toX = Math.cos(gunAngle) * this.size * 1.5;\n    const toY = Math.sin(gunAngle) * this.size * 1.5;\n\n    this.gunTipCoord = [x + toX, y + toY];\n\n    context.moveTo(x + fromX, y + fromY);\n    context.lineTo(x + toX, y + toY);\n    context.stroke();\n  }\n}\n","const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n\nexport function playSound(frequency, type, x, volume = 1) {\n  const o = audioCtx.createOscillator();\n  const g = audioCtx.createGain();\n  o.connect(g);\n  o.type = type;\n  g.connect(audioCtx.destination);\n  o.frequency.value = frequency;\n  o.start();\n  g.gain.value = volume;\n  g.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + x);\n\n  setTimeout(() => {\n    o.stop();\n    o.disconnect();\n  }, (x + 0.5) * 1000);\n}\n","class Collection {\n  constructor() {\n    this.items = [];\n  }\n\n  /**\n   * Add item to collection\n   * @param item\n   */\n  add(item) {\n    this.items.push(item);\n  }\n\n  /**\n   * Add alias\n   * @param args\n   */\n  append(...args) {\n    this.add(...args);\n  }\n\n  /**\n   * Remove item from collection\n   * @param item\n   */\n  remove(item) {\n    this.items = this.items.filter(i => i !== item);\n  }\n\n  /**\n   * Remove alias\n   * @param args\n   */\n  delete(...args) {\n    this.remove(...args);\n  }\n\n  /**\n   * Remove all items\n   */\n  clean() {\n    this.items = [];\n  }\n\n  get size() {\n    return this.items.length;\n  }\n\n  [Symbol.iterator]() {\n    return this.items.values();\n  }\n}\n\nexport default Collection;\n","import random from 'canvas-sketch-util/random';\nimport Collection from '@/utils/collection';\nimport Ship from './Ship';\nimport Enemy from './Enemy';\n\nconst browserSetup = canvas => {\n  canvas.addEventListener('click', () => {\n    canvas.requestPointerLock =\n      canvas.requestPointerLock || canvas.mozRequestPointerLock || canvas.webkitRequestPointerLock;\n\n    canvas.requestPointerLock();\n  });\n};\n\nconst settings = {\n  dimensions: [1201, 1201],\n  animate: true,\n};\n\nconst sketch = async ({ canvas, context, width, height }) => {\n  browserSetup(canvas);\n\n  const backGroundCanvas = document.createElement('canvas');\n  backGroundCanvas.width = width;\n  backGroundCanvas.height = height;\n  const backgroundContext = backGroundCanvas.getContext('2d');\n  backgroundContext.fillStyle = 'hsl(0, 0%, 98%)';\n  backgroundContext.fillRect(0, 0, width, height);\n\n  const gridCanvas = document.createElement('canvas');\n  gridCanvas.width = width;\n  gridCanvas.height = height;\n  const gridContext = gridCanvas.getContext('2d');\n\n  gridContext.lineWidth = 0.05;\n  gridContext.strokeStyle = 'hsla(0, 0%, 50%)';\n  for (let y = 0.5; y < height; y += 50) {\n    gridContext.beginPath();\n    gridContext.moveTo(0, y);\n    gridContext.lineTo(width, y);\n    gridContext.stroke();\n  }\n  for (let x = 0.5; x < width; x += 50) {\n    gridContext.beginPath();\n    gridContext.moveTo(x, 0);\n    gridContext.lineTo(x, height);\n    gridContext.stroke();\n  }\n\n  const fieldSize = Math.min(width, height);\n\n  const game = {\n    running: false,\n  };\n\n  const baseOptions = {\n    context,\n    canvas,\n    fieldSize,\n    width,\n    height,\n    backgroundContext,\n    backGroundCanvas,\n  };\n\n  game.bullets = new Collection();\n  game.enemies = new Collection();\n\n  game.ship = new Ship({\n    baseOptions,\n    game,\n    x: width / 2,\n    y: height / 2,\n  });\n\n  const createEnemy = () => {\n    const pos = random.pick(['top', 'left', 'bottom', 'right']);\n    let x = 0;\n    let y = 0;\n    const offset = 100;\n    switch (pos) {\n      case 'top': {\n        y = -offset;\n        x = random.range(0 - offset, width + offset);\n        break;\n      }\n      case 'right': {\n        x = width + offset;\n        y = random.range(0 - offset, width + offset);\n        break;\n      }\n      case 'bottom': {\n        y = height + offset;\n        x = random.range(0 - offset, width + offset);\n        break;\n      }\n      case 'left': {\n        x = -offset;\n        y = random.range(0 - offset, width + offset);\n        break;\n      }\n      default:\n    }\n    game.enemies.add(new Enemy({ baseOptions, game, x, y }));\n  };\n\n  return ({ context, time }) => {\n    game.time = time;\n\n    backgroundContext.drawImage(gridCanvas, 0, 0);\n    backgroundContext.fillStyle = `hsla(0, 0%, 98%, 0.01)`;\n    backgroundContext.fillRect(0, 0, width, height);\n    context.drawImage(backGroundCanvas, 0, 0);\n\n    if (game.running) {\n      if (game.enemies.size < Math.min(Math.floor((time - game.ship.deadTime) / 3) + 1, 15)) {\n        createEnemy();\n      }\n\n      game.enemies.items.forEach(enemy => {\n        enemy.update();\n        enemy.draw();\n      });\n\n      game.bullets.items.forEach(bullet => {\n        bullet.update();\n        bullet.draw();\n      });\n\n      game.ship.update();\n      game.ship.draw();\n    } else {\n      context.save();\n      context.translate(width / 2, height / 2);\n      context.rotate(Math.cos(time * 5) / 5);\n      context.font = 'bold 90px Arial';\n      context.textAlign = 'center';\n      context.fillStyle = 'hsl(0, 0%, 20%)';\n      context.fillText('Click to start', 0, 0);\n      context.restore();\n    }\n  };\n};\n\nexport default { sketch, settings };\n"],"sourceRoot":""}